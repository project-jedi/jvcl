##Package: System
##Status: Completed (I)
----------------------------------------------------------------------------------------------------
@@JvSHFileOperation.pas
Summary
  Contains the TJvSHFileOperation component.
<INCLUDE JVCL.UnitText.dtx>
Author
  Peter Thörnqvist


----------------------------------------------------------------------------------------------------
@@TJvShFileMappingEvent
<TITLE TJvShFileMappingEvent type>
<COMBINE TJvSHFileOperation.OnFileMapping>

----------------------------------------------------------------------------------------------------
@@TJvSHFileOperation
<TITLEIMG TJvSHFileOperation>
JVCLInfo
  GROUP=JVCL.System.FilesAndFolders
  FLAG=Component
Summary
  Copies, moves, renames, or deletes files, while showing the standard Windows progress dialog.
Description
  TJvSHFileOperation is a wrapper for the windows SHFileOperation function.

  This Windows API function provides the ability to perform a copy, move, rename, or delete operation
  on files, while displaying a dialog box with an animation and an animated progress bar that
  indicates the progress of the operation.

  Use TJvSHFileOperation to get access to the functionality of the SHFileOperation API function in an
  easier to use way. TJvSHFileOperation implements all the functionality of SHFileOperation.

----------------------------------------------------------------------------------------------------
@@TJvSHFileOperation.DestFiles
Summary
  Contains the name of the destination file or directory.
Description
  DestFiles contains the name of the destination file or directory.

  DestFiles must meet the following specifications:

  * Wildcard characters are not supported.
  * \Copy and move operations can specify destination directories that do not exist and the system
    will   attempt to create them. The system normally displays a dialog box to ask the user if they
    want to
    create the new directory. To suppress this dialog box and have the directories created silently,
    include fofNoConfirmMkDir in Options.
  * For copy and move operations, DestFiles can contain multiple destination file names if
    fofMultiDestFiles is included in Options.

  Each file and directory name is translated to a file name with a fully qualified path. So if you
  don't specify a path, the name of the current drive and directory will be merged with the specified
  file name to determine the full path and file name of the specified file.
See Also
  TJvSHFileOperation.SourceFiles

----------------------------------------------------------------------------------------------------
@@TJvSHFileOperation.Execute
Summary
  Performs the file operation.
Description
  Call Execute to perform the operation as specified by Operation.
  Returns
  Execute returns True if no errors occurred and no file operations were aborted by the user, or
  False otherwise.
See Also
  TJvSHFileOperation.Operation

----------------------------------------------------------------------------------------------------
@@TJvSHFileOperation.OnFileMapping
Summary
  Occurs after the file operation when any files were renamed.
Description
  \Write an OnFileMapping event handler to respond after the file operation when any files were
  renamed.

  Only when you include fofRenameOnCollision in Options then the system will give a file a new name
  in a move, copy, or rename operation if a file with the target name already exists. Otherwise, the
  system shows a dialog box that asks for confirmation to replace the already existing target file.
Note
  This event will only occur if you include both fofRenameOnCollision and fofWantMappingHandle in
  Options.
Parameters
  Sender      - The TJvSHFileOperation component that has sent this event.
  OldFileName - Specifies the old name of a renamed file.
  NewFileName - Specifies the new name of a renamed file.
See Also
  TJvSHFileOperation.Options

----------------------------------------------------------------------------------------------------
@@TJvSHFileOperation.Operation
Summary
  Specifies the file operation to perform.
Description
  Set Operation to specify what kind of file operation the component must perform.
See Also
  Execute

----------------------------------------------------------------------------------------------------
@@TJvSHFileOperation.Options
Summary
  \Controls the file operation.
Description
  Use Options to

  * Disable confirmation dialogs.
  * Alter or disable the appearance of the progress dialog.
  * Specify whether files must be renamed or deleted on name collisions.

  By default, all flags except fofAllowUndo and fofFilesOnly are off.

----------------------------------------------------------------------------------------------------
@@TJvSHFileOperation.SourceFiles
Summary
  Contains one or more source file names.
Description
  Set each item in SourceFiles to a filename which can contain
  wildcard characters (* and ?). The asterisk (*) is a wildcard which matches any number of arbitrary
  characters. The question mark (?) is a wildcard which matches a single arbitrary character.

  Use SourceFiles to add, insert, delete and move source file names. Use properties and methods for
  string lists to manipulate the items in the list.

  Each file name is translated to a file name with a fully qualified path. So if you don't specify a
  path, the name of the current drive and directory will be merged with the specified file name to
  determine the full path and file name of the specified file.

  \Include fofFilesOnly in Options to perform the operation as specified by Operation on files only,
  if a wildcard file name is specified.
  \Include fofNoRecursion in Options to operate only in the local directory; thus, the operation will
  not operate recursively into subdirectories if this flag is included in Options.
See Also
  TJvSHFileOperation.DestFiles

----------------------------------------------------------------------------------------------------
@@TJvSHFileOperation.Title
Summary
  Specifies the title of the progress dialog.
Description
  Use Title to specify a title for the progress dialog, that displays the progress of the file
  operation.

  The value of Title is only used if Options includes fofSimpleProgress.
See Also
  TJvSHFileOperation.Options

----------------------------------------------------------------------------------------------------
@@TJvSHFileOption
<TITLE TJvSHFileOption type>
Summary
  \Controls the file operation of a TJvSHFileOperation component.
Description
  The TJvSHFileOption values control the behaviour of the file operation of a TJvSHFileOperation
  component.

  \TJvSHFileOptions is a set of TJvSHFileOption values.
Note
  Some flags are not supported on all Shell32.dll versions, these flags are marked with a version
  number.
  This version number indicates that the programming element was first implemented in that version
  and will also be found in all subsequent versions of the DLL. If no version number is specified,
  the programming element is implemented in all versions.

----------------------------------------------------------------------------------------------------
@@TJvSHFileOption.fofAllowUndo
Preserves Undo information, if possible.

----------------------------------------------------------------------------------------------------
@@TJvSHFileOption.fofConfirmMouse
Not currently used.

----------------------------------------------------------------------------------------------------
@@TJvSHFileOption.fofFilesOnly
Performs the operation on files only, if a wildcard file name is specified.

----------------------------------------------------------------------------------------------------
@@TJvSHFileOption.fofMultiDestFiles
Indicates that the <LINK TJvSHFileOperation.DestFiles,DestFiles> property specifies multiple destination files (one for each source file) rather than one directory where all source files are to be deposited.

----------------------------------------------------------------------------------------------------
@@TJvSHFileOption.fofNoConfirmation
Does not display confimation dialog boxes and responds with "Yes to All" for any dialog box that would be displayed.

----------------------------------------------------------------------------------------------------
@@TJvSHFileOption.fofNoConfirmMkDir
Does not ask for confirmation before creating a new directory if the operation requires one to be created.

----------------------------------------------------------------------------------------------------
@@TJvSHFileOption.fofRenameOnCollision
Gives the file being operated on a new name in a move, copy, or rename operation if a file with the target name already exists. If this flag is not set, the component shows a dialog box that asks for confirmation to replace the already existing target file.

----------------------------------------------------------------------------------------------------
@@TJvSHFileOption.fofSilent
Does not display a progress dialog box.

----------------------------------------------------------------------------------------------------
@@TJvSHFileOption.fofSimpleProgress
Displays a progress dialog box but does not show the file names.

----------------------------------------------------------------------------------------------------
@@TJvSHFileOption.fofWantMappingHandle
Enables the triggering of <LINK TJvSHFileOperation.OnFileMapping,OnFileMapping> events, if fofRenameOnCollision is included in <LINK TJvSHFileOperation.Options,Options> and any files were renamed.

----------------------------------------------------------------------------------------------------
@@TJvSHFileOption.fofNoErrorUI
Does not display a user interface if an error occurs.

----------------------------------------------------------------------------------------------------
@@TJvSHFileOption.fofNoCopySecurityAttributes
Version 4.71. Does not copy the security attributes of the file.

----------------------------------------------------------------------------------------------------
@@TJvSHFileOption.fofNoRecursion
Only operates in the local directory. Does not operate recursively into subdirectories.

----------------------------------------------------------------------------------------------------
@@TJvSHFileOption.fofNoConnectedElements
Version 5.0. Does not move connected files as a group. Only moves the specified files.

----------------------------------------------------------------------------------------------------
@@TJvSHFileOption.fofNoRecurseParse
Version 5.0. Treats reparse points as objects, not containers.

----------------------------------------------------------------------------------------------------
@@TJvSHFileOption.fofWantNukeWarning
Version 5.0. Sends a warning if a file is being destroyed during a delete operation rather than recycled. This flag partially overrides fofNoConfirmation.

----------------------------------------------------------------------------------------------------
@@TJvSHFileOptions
<TITLE TJvSHFileOptions type>
<COMBINE TJvSHFileOption>

----------------------------------------------------------------------------------------------------
@@TJvSHFileOpType
<TITLE TJvSHFileOpType type>
Summary
  Represents different kinds of file operations.
Description
  Use the TJvSHFileOpType type to specify a specific kind of file operation for a TJvSHFileOperation
  component.

----------------------------------------------------------------------------------------------------
@@TJvSHFileOpType.foCopy
Copies the files specified by <LINK TJvSHFileOperation.SourceFiles,SourceFiles> to the location specified by <LINK TJvSHFileOperation.DestFiles,DestFiles>.

----------------------------------------------------------------------------------------------------
@@TJvSHFileOpType.foDelete
Deletes the files specified by <LINK TJvSHFileOperation.SourceFiles,SourceFiles>.

----------------------------------------------------------------------------------------------------
@@TJvSHFileOpType.foMove
Moves the files specified by <LINK TJvSHFileOperation.SourceFiles,SourceFiles> to the location specified by <LINK TJvSHFileOperation.DestFiles,DestFiles>.

----------------------------------------------------------------------------------------------------
@@TJvSHFileOpType.foRename
Renames the file specified by <LINK TJvSHFileOperation.SourceFiles,SourceFiles>. This operation cannot rename multiple files with a single function call. Use foMove instead.

